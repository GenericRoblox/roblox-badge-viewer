<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Roblox Badge Game Links</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>Roblox Badge Game Links</h1>
    <input id="username" type="text" placeholder="Enter Roblox username">
    <button onclick="fetchBadges()">Get Badges</button>
    <ul id="badgeLinks"></ul>
  </div>

  <script>
    async function fetchBadges() {
      const username = document.getElementById('username').value.trim();
      const list = document.getElementById('badgeLinks');
      list.innerHTML = '';

      if (!username) {
        list.innerHTML = '<li>Please enter a username.</li>';
        return;
      }

      try {
        // Use Rover API to get user ID (CORS-safe)
        const resUser = await fetch(`https://api.rover.link/v1/user/${username}`);
        const userData = await resUser.json();

        if (!userData.robloxId) {
          list.innerHTML = '<li>User not found.</li>';
          return;
        }

        const userId = userData.robloxId;

        // Fetch recent badges
        const resBadges = await fetch(`https://badges.roblox.com/v1/users/${userId}/badges?limit=10&sortOrder=Desc`);
        const badgeData = await resBadges.json();

        if (!badgeData.data || badgeData.data.length === 0) {
          list.innerHTML = '<li>No badges found.</li>';
          return;
        }

        // Show game links from badges
        badgeData.data.forEach(badge => {
          const placeId = badge.awarder?.id;
          const gameLink = `https://www.roblox.com/games/${placeId}`;
          const li = document.createElement('li');
          li.innerHTML = `<a href="${gameLink}" target="_blank">${badge.displayName}</a>`;
          list.appendChild(li);
        });
      } catch (error) {
        list.innerHTML = '<li>Error fetching data. Check console.</li>';
        console.error(error);
      }
    }
  </script>
</body>
</html>
